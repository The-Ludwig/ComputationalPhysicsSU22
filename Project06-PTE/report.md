---
title: Computational Physics -- 6 -- The Periodic System
author:
- Ludwig Neste
header-includes: |
    \usepackage{blindtext}
    \usepackage[section, below]{placeins}
papersize: a4
fontfamily: libertinus
geometry: 
- left=1cm
- right=1cm
- top=2cm
- bottom=2cm
classoption:
- twocolumn
...

# The Physical Problem
The stationary Schrödinger equation 
$$
\hat H(\vec x_1, \dots, \vec x_N) \Psi(\vec x_1, \dots, \vec x_N)  = E \Psi(\vec x_1, \dots, \vec x_N)
$$
governs the behavior of non-relativistic, subatomic particles, such as multiple electrons around a (stationary) nucleus, which is an atom. 
For this problem, with a nucleus charge of $Z$ and $N$ electrons, the Hamiltonian is
$$
\hat H(\vec x_1, \dots, \vec x_N) = -\sum_{i=1}^{N}\frac{\hbar^2\nabla_i^2}{2m_{\mathrm{e}}}-\frac{Ze^2}{4\pi \epsilon_0 |\vec x_i|}
+\frac{1}{2}\sum_{\substack{i,j=1 \\ i\neq j}}^{N} \frac{e^2}{4\pi \epsilon_0 |\vec x_i-\vec x_j|}.
$$
This problem is factually impossible to solve for even a few electrons, 
because of the interaction of the electrons. 
We will use the *mean-field* approximation to reduce the problem to a set of 
single-particle problems. This mean-field approximation assumes that one 
electron just sees a static potential generated by all the electrons.
The corressponding Hamiltonian then looks like this:
$$
\hat H(\vec x) = -\frac{\hbar^2\nabla^2}{2m_{\mathrm{e}}}-\frac{Ze^2}{4\pi \epsilon_0 |\vec x|}
+V_{ee}(\vec x).
$$
$V_{ee}$ is the potential generated by the electrons. 

Since this Hamiltonian is spherically symmetric, it is useful to express the wavefunction 
in terms of radial basis functions
$$
\Psi(\vec x) = \Psi(r, \theta, \varphi) =\frac{P_{nl}(r)}{r}Y_{lm}(\theta, \varphi).
$$
Where $P_{nl}/r$ is the radial part of the solution and $Y_{lm}$ are the basis functions on 
the surface of a sphere, the spherical harmonics. With this we can write the 
associated Schrödinger equation in Hartree units as 
$$
\left(-\frac{\partial_r^2}{2}+\frac{ l(l+1)}{2}-\frac{Z}{r}+V_{ee}(r)\right){P_{nl}(r)}
= 
E_{nl}P_{nl}(r).
$$
In a classical view we can calculate the potential with the Poisson equation 
$$
\nabla^2 V_{ee}(\vec x) = -4\pi\rho(\vec x).
$$
$\rho$ will be obtained by first solving the problem without 
any interaction, then plugging in the results for each electron to obtain $\rho$ as
$$
\rho(r)
= \frac{1}{4\pi} \sum_{j=1}^{N_{\mathrm{orbitals}}}N_j \left(\frac{P_{n_j l_j}(r)}{r}\right)^2.
$$
Then we solve the problem again with this $\rho$ and this goes on until the solution converges.

Because we calculate the Potential in a purely classical view, we neglect some effects like 
the *Pauli exclusion principle* and the non existence of self-interaction (currently our electron is also seeing
its own potential.).
To account for that, we set introduce a heuristic Exchange-Potential:
$$
V_{\mathrm{ex}}(r) = -3 \left(\frac{3\rho(r)}{8\pi}\right)^{1/3}.
$$
This form is derived with using a free electron gas model.
The Hamiltonian then is 
$$
-\frac{\partial_r^2}{2}+\frac{ l(l+1)}{2}-\frac{Z}{r}+V_{ee}(r)+V_{\mathrm{ex}}(r).
$$

In the iteration of replacing the old potential with the new one, 
the solutions will oscillate, since first no electron sees any other electrons, then 
they are suddenly repelled, and so on. To supress this, 
we will not directly introduce the new potential, but mix it with the old 
one with a factor of $\eta$:
$$
V_{ee}^{\mathrm{applied}}+V_{\mathrm{ex}}^{\mathrm{applied}} 
= (1-\eta)(V_{ee}^{\mathrm{new}}+V_{\mathrm{ex}}^{\mathrm{new}})+
\eta (V_{ee}^{\mathrm{old}}+V_{\mathrm{ex}}^{\mathrm{old}}).
$$

The actual binding energy of whole atom then needs to account for the doubly counted 
e-e interaction:
$$
E_{\mathrm{total}} = \sum_{j=1}^{N_{\mathrm{orbitals}}} N_j
\left (
E_{nl} - \frac{1}{2}\int_0^{\infty} P_{nl}^2(r) (V_{ee}(r)+V_{\mathrm{ex}}(r))\mathrm{d}r
\right ).
$$

# Numerical Methods 
The numerical methods are the same as in the last two assignments, the only difference is, 
that now I use dense matrices to solve the atomic problem, since that method is more stable.
For the solution of the Poission equation sparse matrices are still in use.

The iteration is stopped when the euclidean norm of the orbital energies does 
not change more than $10^{-6}\mathrm{Ht}$, or if it takes more than 100 iterations to converge. 
This will introduce some artifacts in the following plots.

# Results

All plots are created with 50 knot points for the atomic problem 
and a 1000 knot points for the Poisson equation. Both were 
exponentially distributed between 0 and $1000a_0$.

First we test the influence of $\eta$ to the number of needed iterations until 
convergence. You can see this for the ground state of $\mathrm{Ne}$ in 
\autoref{fig:eta}. For all the future plots $\eta = 0.35$ is chosen. Note 
that this value will probably also depend on the element we choose.

![Dependence of the number of iterations needed for the groundstate of $\mathrm{Ne}$ to converge on $\eta$.\label{fig:eta}](build/plots/etas.pdf)

\FloatBarrier

Next to check the results the probability density of finding an electron at $r$ $P(r)$ is 
plottet for a few different elements, and their ionized states.

![Radial probability of finding an electron for $\mathrm{O}$. Knots to solve the atomic problem are shown as blue lines.](build/plots/O.pdf)

![Radial probability of finding an electron for $\mathrm{Ne}$. Knots to solve the atomic problem are shown as blue lines.](build/plots/Ne.pdf)

![Radial probability of finding an electron for $\mathrm{Ne+}$. Knots to solve the atomic problem are shown as blue lines.](build/plots/Ne+.pdf)

![Radial probability of finding an electron for $\mathrm{Kr}$. Knots to solve the atomic problem are shown as blue lines.](build/plots/Kr.pdf)

\FloatBarrier

The big question is: Can we explain the ionization energies of the periodic table with our method?
For that we have to solve the problem once for each element and its ionized version. 
To know how the electrons occupy the orbitals in the atom, we (in theory) have to solve the 
problem for every thinkable combination of occupation and see which has the lowest energy. 
In practice there are heuristic rules which hold for most elements, such as the *Aufbau*-principle or 
*Hund's*-rule. These will fail for some elements (such as copper).
Since checking all the reasonable electron configurations for each element is very costly, and *Hund's* rule 
is only approximate, we will for now use the literature values found in the `mendeleev`-python package.
With that the ionization energies of every element (from $Z=2$ to $Z=99$) are simulated and compared to literature 
values in \autoref{fig:ions}. 
Only the elements which actually converge in less than 100 steps are shown. We can see that we can predict the values for some elements 
quite successfully and in some regions also the shape looks very good, in other regions the values are pretty wrong.

![Simulated ionization energies and the literature values for almost every element. \label{fig:ions}](build/plots/ionization.pdf)



# Remarks

To make every element converge reasonably, we should find optimal parameters like $\eta$ and the knot points for each 
atom individually, instead of one overall parameter. 
